const db = require("../db/queries");
//Seems a bit messy. Might be best to at some point separate the function
//and give each 'if' its own function. This will work for now.
async function getInventory(req, res) {
    const category = req.query.category;
    if(category == undefined){
      const categories = await db.getAllCategories();
      res.send(categories);
    }
    else if(category==''){
      const inventory = await db.getAllInventory();
      res.send(inventory);
    }
    else if(category=='all'){
      const categories = await db.getAllCategories();
      for(i in categories){
        const inventory = await db.getCategoryInventory(categories[i].category);
        categories[i]['inventory'] = inventory;
      }
      res.send(categories);
    }
    else{
      const inventory = await db.getCategoryInventory(category);
      const categories = [{category: category, inventory: inventory}];
      res.send(categories);
    }
    /*
    res.send("Usernames: " + inventory.map(item => item.name).join(", ")); */
    
  }

async function getCategories(req,res){
  const categories = await db.getAllCategories();
  res.send(categories);
}
    
module.exports = {
    getInventory,
    getCategories
};